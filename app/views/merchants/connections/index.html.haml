= banner("#{current_shop.name} - Connections")
= link_to "Add new user", add_user_merchants_connections_path, :style => "margin-top: -62px; position: absolute; margin-left: 845px;", :class => "btn btn-primary"

#merchants.pad3pc
  #filter_Form
    = render partial: 'filter_form'
  %hr
  %p.pull-left
    Here's a list of all your connections. Click on name of customer to learn more.
  %a.btn.btn-primary{:href => merchants_file_imports_path, :style => "float: right"} Import Customers
  %table.table.table-striped
    %thead
      %tr
        %th #
        %th Customer
        %th Tags
        %th Profile
    %tbody
      - email_id = Permission.email_id
      - name_id = Permission.name_id

      - @connections.each_with_index do |connection, index|
        %tr
          %td= index + 1
          %td
            = connection_user_display_name(connection, name_id, email_id)
          %td
            = connection.user.user_labels.blank? ? "---" : connection.user.user_labels.map{|s| s.label.name.capitalize}.join(", ")
          %td
            - if connection.user.permissions_users.present?
              %a{:href => "#", "data-toggle" => "modal", "id" => "#{connection.user_id}", "class" => "open-infoDialog"} More Info
              %div{:id => "infoDialog_#{connection.user.id}", :class => "modal hide fade", :tabindex => "-1", :role => "dialog", :'aria-labelledby' => "myModalLabel", :'aria-hidden' => "true"}
              = hidden_field_tag "show_path_#{connection.user.id}", merchants_connection_path(connection.user.id)
              / = render partial: 'more_info_prompt', locals:{user: connection.user, name_id: name_id, email_id: email_id, :status => status, :connection => connection}
            - else
              %a{:href => "#",:style => "color:#7D8B8F"} More Info

  = paginate @connections
