%h1
  Import Customers for
  = current_shop.name

#dashboard.pad3pc
  %p If you have a previous email list, you can easily import it into Optyn below. 
  %p
    You could download the
    = link_to "Sample File", "/file_import_stub.csv"
    here
  .import
    %br
    %br
      = form_for :file_import, :url => merchants_file_imports_path, :method => "post", multipart: true, html: {class: 'form-horizontal'} do |f|
        .control-group
          = f.label :csv_file, "Customer CSV file to Import", class: 'control-label'
          .controls
            = f.file_field :csv_file

        .control-group
          = f.label :label, "Label for import records", class: 'control-label'
          .controls
            = f.text_field :label, value: (params[:file_import][:label] rescue FileImport::DEFAULT_LABEL_NAME)

        .actions
          = f.submit "Import", class: "btn btn-primary"


    %table.table.table-striped.table-hover
      %thead
        %tr
          %th #
          %th Name
          %th Status
          %th Label
          %th Stats
          %th Uploaded
      %tbody
        - if @file_imports.present?
          - @file_imports.each_with_index do |import, index|
            %tr
              %td= index + 1
              %td
                = File.basename(import.csv_file.to_s)
              %td
                = import.status.humanize rescue "-"
              %td
                = import.label
              %td
                - if import.stats.present?
                  - import.stats.each_pair do |key, value|
                    == #{key.to_s.humanize.pluralize} = #{value}
                    %br
                - else
                  N/A
              %td
                = human_time(import.created_at) rescue "-"
        - else
          %tr
            %td{colspan: 5}
              No files uploaded yet for imports.
