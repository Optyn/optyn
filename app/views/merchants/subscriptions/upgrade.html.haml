= display_title "Upgrade your Account"
= banner("Pricing and Invoices")

= render partial: 'merchants/merchant_managers/tabs'

.row-fluid.text-center
  .well.span3
    %h5 You Current Plan:
    = @plan.min 
    = @plan.max
    %br
    = link_to "view plans","/pricing"
  .well.span3
    %h5 Last Payment:
  .well.span3
    %h5 Upcoming Payment:
    (pricing tier may change)
    %br
    = @stripe_upcoming_payment
  .well.span3
    %h5 Credit Card on File:
    %p ending in 
    %br
    %a.btn( href='#' )Update Card

.blank-space

.row-fluid
  .span12
    %h2 Your Payment History
    %table.table.table-striped.table-hover
      %thead
        %tr
          %td Date
          %td Amount
          %td Plan
          %td View invoice
      %tbody
        %tr
          %td xx-xx-xxxx
          %td $X.X
          %td Foo
          %td Bar

#box_login
  .row-fluid
    .span12.box_wrapper
      .box.span4.offset4
        %div 
          .head
            %h4 Enter Your Payment Information 
          .payment-errors
            - if @subscription.errors.any? || @subscription.stripe_error
              =@subscription.stripe_error
              %ul
                - @subscription.errors.full_messages.each do |error|
                  %li
                    = error  


          .form.row-fluid
            = form_for @subscription, :url => merchants_subscribe_path ,:html=>{:id =>"stripe-form"} do |f|

              = f.hidden_field :plan_id, :value => @plan.id
              = f.hidden_field :email, :value => current_merchants_manager.email
              = f.hidden_field :shop_id, :value => current_merchants_manager.shop.id

              = hidden_field_tag :stripe_plan_id,nil, :value => @plan.plan_id

              = text_field_tag :credit_card, nil,:placeholder => "16 digit Credit card number",:autocomplete=>"off",:class=>'credit-number pull-left', 'data-toggle' => 'tooltip', title: 'Your 16 digit Credit Card number'

              = text_field_tag :cvv,nil, :placeholder => "CVV",:class=>'credit-security', 'data-toggle' => 'tooltip', title: 'CVV'

              = select_month(Date.today, {},{:class => "card-expiry-month pull-left selectbox span12", 'data-toggle' => 'tooltip', title: 'Card expiry month'})

              = select_year(Date.today,{:start_year => Date.today.year },{:class => "card-expiry-year pull-left selectbox span12", 'data-toggle' => 'tooltip', title: 'Card expiry year'})

              = f.submit "Pay", :class => "btn btn-block btn-success"
        %div{:style => "text-align: center; margin-top: 25px;"}
          %p
            All payments are processed securely.

:javascript
  $( document ).ready( equalizeDivHeights( '.well.span3' ));
